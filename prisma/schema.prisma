// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User { 
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum ToolType {
  SHOPPING
  LEARNING
  WIKI
  BASE
}

model Tool {
  id          Int      @id @default(autoincrement())
  name        String  
  description String?
  type        ToolType
  
  // Tool-specific data (one-to-one)
  shoppingTool ShoppingTool?
  learningTool LearningTool?
  
  modules     Module[]  // A tool has many modules
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model ShoppingTool {
  toolId      Int     @id
  tool        Tool    @relation(fields: [toolId], references: [id], onDelete: Cascade)
  
  currency    String  @default("USD")
  autoSync    Boolean @default(false)
}

model LearningTool {
  toolId      Int     @id
  tool        Tool    @relation(fields: [toolId], references: [id], onDelete: Cascade)
  
  difficulty  String?
  tracked     Boolean @default(true)
}

model Module {
  id          Int      @id @default(autoincrement())
  name        String 
  description String?
  toolId      Int
  
  tool        Tool     @relation(fields: [toolId], references: [id], onDelete: Cascade)
  items       Item[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Item {
  id        Int      @id @default(autoincrement())
  name      String
  price     Decimal? @db.Decimal(10, 2)
  moduleId  Int
  
  module    Module   @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
